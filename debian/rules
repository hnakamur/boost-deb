#! /usr/bin/make -f

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# This has to be exported to make some magic below work.
export DH_OPTIONS

# Boost Version
# This is the "short label" for the Boost library version, consisting of the
# major and minor version numbers joined by an underscore.
#
boost_version = 1_34
gcc_version = gcc41

# Library suffix
# Boost libraries encode build information in the resulting library
# filename: toolset, threading, runtime, and version.
#
release_suffix_st = -$(gcc_version)-$(boost_version)
debug_suffix_st = -$(gcc_version)-d-$(boost_version)
release_suffix_mt = -$(gcc_version)-mt-$(boost_version)
debug_suffix_mt = -$(gcc_version)-mt-d-$(boost_version)

# Boost does not guarantee any ABI, it uses the full version in SONAME
SOVERSION = 1.34.0
DEBIAN_SUFFIX =

DEB_BUILD_ARCH ?= $(shell dpkg-architecture -qDEB_BUILD_ARCH)

TOOLSET_CONFIG="using gcc : : : <define>_REENTRANT <compileflags>-mlong-calls ;"
ifneq ($(DEB_BUILD_ARCH), hppa)
TOOLSET_CONFIG="using gcc : : : <define>_REENTRANT ;"
endif
PYTHON_CONFIG="using python : 2.5 : /usr ;"

exampledir = debian/libboost-doc/usr/share/doc/libboost-doc/examples
htmldir = debian/libboost-doc/usr/share/doc/libboost-doc/HTML
pyste_prefix = $(PWD)/debian/pyste/usr
bjam = tools/jam/src/bjam

JAM = $(bjam) -d2 --user-config=$(shell pwd)/user-config.jam -sHAVE_ICU=1

$(bjam):
	cd tools/jam/src && sh build.sh gcc && mv bin.*/bjam .

build: build-stamp
build-stamp: $(bjam)
	dh_testdir

	echo $(TOOLSET_CONFIG) >> user-config.jam
	echo $(PYTHON_CONFIG) >> user-config.jam

	cd tools/bcp && ../../$(JAM)
	cd tools/inspect/build && ../../../$(JAM)
	cd tools/wave/build && ../../../$(JAM)
	cd tools/regression/build && ../../../$(JAM)

	$(JAM) -sBUILD="release debug <threading>single/multi"
	cd libs/python/pyste/install && python2.5 setup.py build

	touch build-stamp

clean:
	dh_testdir
	dh_testroot
	rm -f build-stamp

	-cd tools && ../$(JAM) clean
	-$(JAM) clean
	cd libs/python/pyste/install && python2.5 setup.py clean

	rm -rf libs/python/pyste/install/build
	rm -rf tools/jam/src/bootstrap
	rm -rf tools/jam/src/bin.*
	rm -ff tools/jam/src/bjam
	rm -rf bin.v2 dist
	rm -rf user-config.jam

	dh_clean

install: DH_OPTIONS=-X.svn
install: build
	dh_testdir
	dh_testroot
	dh_clean -k

	$(JAM) --prefix=`pwd`/debian/tmp/usr install

	find debian/tmp/usr/include -type f | xargs chmod 644
	find debian/tmp -name .cvsignore | xargs rm -f
	find debian -empty -type f | xargs rm -f


	# package pyste
	cd libs/python/pyste/install && python setup.py install --no-compile --prefix=$(pyste_prefix) --install-lib=$(pyste_prefix)/share/python-support/pyste
	mv $(pyste_prefix)/bin/pyste.py $(pyste_prefix)/bin/pyste


	# package bcp
	dh_installdirs -pbcp usr/bin
	dh_install -pbcp dist/bin/bcp usr/bin
	dh_installman -pbcp debian/bcp.1


	# package libboost-dbg
	dh_installdirs -plibboost-dbg usr/share/lintian/overrides
	dh_install -plibboost-dbg \
	   debian/libboost-dbg.lintian-overrides \
	   usr/share/lintian/overrides/libboost-dbg


	# package libboost-dev
	dh_install -plibboost-dev \
	   debian/tmp/usr/include/boost-$(boost_version)/boost \
	   usr/include
	dh_installdirs -plibboost-dev usr/share/lintian/overrides
	dh_install -plibboost-dev \
	   debian/libboost-dev.lintian-overrides \
	   usr/share/lintian/overrides/libboost-dev


	# package libboost-doc
	rm -rf $(htmldir)
	mkdir -p $(htmldir) $(htmldir)/more/css_0
	cp more/css_0/* $(htmldir)/more/css_0
	cat debian/documentation-files | xargs cp --parents --target-directory=$(htmldir)
	rm -rf $(htmldir)/boost
	dh_link -plibboost-doc \
	   usr/include/boost \
	   usr/share/doc/libboost-doc/HTML/boost

	mkdir -p $(exampledir)
	cat debian/example-files | xargs cp -a --parents --target-directory=$(exampledir)
	find $(exampledir) -type f | xargs chmod 644
	dh_installdirs -plibboost-doc usr/share/lintian/overrides
	dh_install -plibboost-doc \
	   debian/libboost-doc.lintian-overrides \
	   usr/share/lintian/overrides/libboost-doc


	# package libboost-date-time$(SOVERSION)
	dh_install -plibboost-date-time$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_date_time$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_date_time$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-date-time-dev
	dh_installdirs -plibboost-date-time-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/date_time \
	   debian/libboost-date-time-dev/usr/include/boost
	dh_install -plibboost-date-time-dev --autodest \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_mt).so \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_date_time$(release_suffix_st).so
	dh_link -plibboost-date-time-dev \
	   usr/lib/libboost_date_time$(release_suffix_st).a   usr/lib/libboost_date_time-st.a \
	   usr/lib/libboost_date_time$(release_suffix_st).so  usr/lib/libboost_date_time-st.so \
	   usr/lib/libboost_date_time$(release_suffix_mt).a   usr/lib/libboost_date_time-mt.a \
	   usr/lib/libboost_date_time$(release_suffix_mt).so  usr/lib/libboost_date_time-mt.so


	# package libboost-filesystem$(SOVERSION)
	dh_install -plibboost-filesystem$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_filesystem$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_filesystem$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-filesystem-dev
	dh_installdirs -plibboost-filesystem-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/filesystem \
	   debian/libboost-filesystem-dev/usr/include/boost
	dh_install -plibboost-filesystem-dev --autodest \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_filesystem$(release_suffix_mt).so
	dh_link -plibboost-filesystem-dev \
	   usr/lib/libboost_filesystem$(release_suffix_st).a   usr/lib/libboost_filesystem-st.a \
	   usr/lib/libboost_filesystem$(release_suffix_st).so  usr/lib/libboost_filesystem-st.so \
	   usr/lib/libboost_filesystem$(release_suffix_mt).a   usr/lib/libboost_filesystem-mt.a \
	   usr/lib/libboost_filesystem$(release_suffix_mt).so  usr/lib/libboost_filesystem-mt.so


	# package libboost-graph$(SOVERSION)
	dh_install -plibboost-graph$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_graph$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_graph$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-graph-dev
	dh_installdirs -plibboost-graph-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/graph \
	   debian/libboost-graph-dev/usr/include/boost
	dh_install -plibboost-graph-dev --autodest \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_graph$(release_suffix_mt).so
	dh_link -plibboost-graph-dev \
	   usr/lib/libboost_graph$(release_suffix_st).a   usr/lib/libboost_graph-st.a \
	   usr/lib/libboost_graph$(release_suffix_st).so  usr/lib/libboost_graph-st.so \
	   usr/lib/libboost_graph$(release_suffix_mt).a   usr/lib/libboost_graph-mt.a \
	   usr/lib/libboost_graph$(release_suffix_mt).so  usr/lib/libboost_graph-mt.so


	# package libboost-iostreams$(SOVERSION)
	dh_install -plibboost-iostreams$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_iostreams$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_iostreams$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-iostreams-dev
	dh_installdirs -plibboost-iostreams-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/iostreams* \
	   debian/libboost-iostreams-dev/usr/include/boost
	dh_install -plibboost-iostreams-dev --autodest \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_iostreams$(release_suffix_mt).so
	dh_link -plibboost-iostreams-dev \
	   usr/lib/libboost_iostreams$(release_suffix_st).a   usr/lib/libboost_iostreams-st.a \
	   usr/lib/libboost_iostreams$(release_suffix_st).so  usr/lib/libboost_iostreams-st.so \
	   usr/lib/libboost_iostreams$(release_suffix_mt).a   usr/lib/libboost_iostreams-mt.a \
	   usr/lib/libboost_iostreams$(release_suffix_mt).so  usr/lib/libboost_iostreams-mt.so


	# package libboost-program-options$(SOVERSION)
	dh_install -plibboost-program-options$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_program_options$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_program_options$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-program-options-dev
	dh_installdirs -plibboost-program-options-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/program_options* \
	   debian/libboost-program-options-dev/usr/include/boost
	dh_install -plibboost-program-options-dev --autodest \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_program_options$(release_suffix_mt).so
	dh_link -plibboost-program-options-dev \
	   usr/lib/libboost_program_options$(release_suffix_st).a   usr/lib/libboost_program_options-st.a \
	   usr/lib/libboost_program_options$(release_suffix_st).so  usr/lib/libboost_program_options-st.so \
	   usr/lib/libboost_program_options$(release_suffix_mt).a   usr/lib/libboost_program_options-mt.a \
	   usr/lib/libboost_program_options$(release_suffix_mt).so  usr/lib/libboost_program_options-mt.so


	# package libboost-python$(SOVERSION)
	dh_install -plibboost-python$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_python$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_python$(debug_suffix_mt).so.$(SOVERSION)
	dh_installdirs -plibboost-python$(SOVERSION)${DEBIAN_SUFFIX} usr/share/lintian/overrides
	dh_install -plibboost-python$(SOVERSION)${DEBIAN_SUFFIX} \
	   debian/libboost-python$(SOVERSION)${DEBIAN_SUFFIX}.lintian-overrides \
	   usr/share/lintian/overrides/libboost-python$(SOVERSION)${DEBIAN_SUFFIX}


	# package libboost-python-dev
	dh_installdirs -plibboost-python-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/python* \
	   debian/libboost-python-dev/usr/include/boost
	dh_install -plibboost-python-dev --autodest \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_python$(release_suffix_mt).so
	dh_link -plibboost-python-dev \
	   usr/lib/libboost_python$(release_suffix_st).a   usr/lib/libboost_python-st.a \
	   usr/lib/libboost_python$(release_suffix_st).so  usr/lib/libboost_python-st.so \
	   usr/lib/libboost_python$(release_suffix_mt).a   usr/lib/libboost_python-mt.a \
	   usr/lib/libboost_python$(release_suffix_mt).so  usr/lib/libboost_python-mt.so
	dh_installdirs -plibboost-python-dev usr/share/lintian/overrides
	dh_install -plibboost-python-dev \
	   debian/libboost-python-dev.lintian-overrides \
	   usr/share/lintian/overrides/libboost-python-dev


	# package libboost-regex$(SOVERSION)
	dh_install -plibboost-regex$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_regex$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_regex$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-regex-dev
	dh_installdirs -plibboost-regex-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/*regex* \
	   debian/libboost-regex-dev/usr/include/boost
	dh_install -plibboost-regex-dev --autodest \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_regex$(release_suffix_mt).so
	dh_link -plibboost-regex-dev \
	   usr/lib/libboost_regex$(release_suffix_st).a   usr/lib/libboost_regex-st.a \
	   usr/lib/libboost_regex$(release_suffix_st).so  usr/lib/libboost_regex-st.so \
	   usr/lib/libboost_regex$(release_suffix_mt).a   usr/lib/libboost_regex-mt.a \
	   usr/lib/libboost_regex$(release_suffix_mt).so  usr/lib/libboost_regex-mt.so


	# package libboost-serialization$(SOVERSION)
	dh_install -plibboost-serialization$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_mt).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_serialization$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wserialization$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_serialization$(debug_suffix_mt).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wserialization$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-serialization-dev
	dh_installdirs -plibboost-serialization-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/*serialization* \
	   debian/libboost-serialization-dev/usr/include/boost
	dh_install -plibboost-serialization-dev --autodest \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_serialization$(release_suffix_mt).so \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_wserialization$(release_suffix_mt).so
	dh_link -plibboost-serialization-dev \
	   usr/lib/libboost_serialization$(release_suffix_st).a    usr/lib/libboost_serialization-st.a \
	   usr/lib/libboost_serialization$(release_suffix_st).so   usr/lib/libboost_serialization-st.so \
	   usr/lib/libboost_wserialization$(release_suffix_st).a   usr/lib/libboost_wserialization-st.a \
	   usr/lib/libboost_wserialization$(release_suffix_st).so  usr/lib/libboost_wserialization-st.so \
	   usr/lib/libboost_serialization$(release_suffix_mt).a    usr/lib/libboost_serialization-mt.a \
	   usr/lib/libboost_serialization$(release_suffix_mt).so   usr/lib/libboost_serialization-mt.so \
	   usr/lib/libboost_wserialization$(release_suffix_mt).a   usr/lib/libboost_wserialization-mt.a \
	   usr/lib/libboost_wserialization$(release_suffix_mt).so  usr/lib/libboost_wserialization-mt.so


	# package libboost-signals$(SOVERSION)
	dh_install -plibboost-signals$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_signals$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_signals$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-signals-dev
	dh_installdirs -plibboost-signals-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/*signal* \
	   debian/libboost-signals-dev/usr/include/boost
	dh_install -plibboost-signals-dev --autodest \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_signals$(release_suffix_mt).so
	dh_link -plibboost-signals-dev \
	   usr/lib/libboost_signals$(release_suffix_st).a   usr/lib/libboost_signals-st.a \
	   usr/lib/libboost_signals$(release_suffix_st).so  usr/lib/libboost_signals-st.so \
	   usr/lib/libboost_signals$(release_suffix_mt).a   usr/lib/libboost_signals-mt.a \
	   usr/lib/libboost_signals$(release_suffix_mt).so  usr/lib/libboost_signals-mt.so


	# package libboost-test$(SOVERSION)
	dh_install -plibboost-test$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_mt).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(debug_suffix_mt).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-test-dev
	dh_installdirs -plibboost-test-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/test \
	   debian/libboost-test-dev/usr/include/boost
	dh_install -plibboost-test-dev --autodest \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_prg_exec_monitor$(release_suffix_mt).so \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_unit_test_framework$(release_suffix_mt).so
	dh_link -plibboost-test-dev \
	   usr/lib/libboost_prg_exec_monitor$(release_suffix_st).a   usr/lib/libboost_prg_exec_monitor-st.a \
	   usr/lib/libboost_prg_exec_monitor$(release_suffix_st).so  usr/lib/libboost_prg_exec_monitor-st.so \
	   usr/lib/libboost_unit_test_framework$(release_suffix_st).a  usr/lib/libboost_unit_test_framework-st.a \
	   usr/lib/libboost_unit_test_framework$(release_suffix_st).so usr/lib/libboost_unit_test_framework-st.so \
	   usr/lib/libboost_prg_exec_monitor$(release_suffix_mt).a   usr/lib/libboost_prg_exec_monitor-mt.a \
	   usr/lib/libboost_prg_exec_monitor$(release_suffix_mt).so  usr/lib/libboost_prg_exec_monitor-mt.so \
	   usr/lib/libboost_unit_test_framework$(release_suffix_mt).a  usr/lib/libboost_unit_test_framework-mt.a \
	   usr/lib/libboost_unit_test_framework$(release_suffix_mt).so usr/lib/libboost_unit_test_framework-mt.so


	# package libboost-thread$(SOVERSION)
	dh_install -plibboost-thread$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_thread$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_thread$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-thread-dev
	dh_installdirs -plibboost-thread-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/thread* \
	   debian/libboost-thread-dev/usr/include/boost
	dh_install -plibboost-thread-dev --autodest \
	   debian/tmp/usr/lib/libboost_thread$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_thread$(release_suffix_mt).so
	dh_link -plibboost-thread-dev \
	   usr/lib/libboost_thread$(release_suffix_mt).a   usr/lib/libboost_thread-mt.a \
	   usr/lib/libboost_thread$(release_suffix_mt).so  usr/lib/libboost_thread-mt.so


	# package libboost-wave$(SOVERSION)
	dh_install -plibboost-wave$(SOVERSION)$(DEBIAN_SUFFIX) --autodest \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_mt).so.$(SOVERSION)
	dh_install -plibboost-dbg --autodest \
	   debian/tmp/usr/lib/libboost_wave$(debug_suffix_st).so.$(SOVERSION) \
	   debian/tmp/usr/lib/libboost_wave$(debug_suffix_mt).so.$(SOVERSION)


	# package libboost-wave-dev
	dh_installdirs -plibboost-wave-dev usr/include/boost
	mv debian/libboost-dev/usr/include/boost/wave* \
	   debian/libboost-wave-dev/usr/include/boost
	dh_install -plibboost-wave-dev --autodest \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_st).a \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_st).so \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_mt).a \
	   debian/tmp/usr/lib/libboost_wave$(release_suffix_mt).so
	dh_link -plibboost-wave-dev \
	   usr/lib/libboost_wave$(release_suffix_st).a   usr/lib/libboost_wave-st.a \
	   usr/lib/libboost_wave$(release_suffix_st).so  usr/lib/libboost_wave-st.so \
	   usr/lib/libboost_wave$(release_suffix_mt).a   usr/lib/libboost_wave-mt.a \
	   usr/lib/libboost_wave$(release_suffix_mt).so  usr/lib/libboost_wave-mt.so


# This single target is used to build all the packages, all at once, or
# one at a time. So keep in mind: any options passed to commands here will
# affect _all_ packages. Anything you want to only affect one package
# should be put in another target, such as the install target.
binary-common:
	dh_testdir
	dh_testroot
	dh_installdocs --all debian/README.Debian
	dh_installexamples
	dh_installinfo
	dh_installchangelogs
	dh_strip -Nlibboost-dbg
	dh_link
	dh_compress -Xlibboost-doc/HTML
	dh_pysupport
	dh_python
	dh_fixperms

	@if [ "$(DH_OPTIONS)" = "-a" ]; then \
		for name in date-time filesystem graph iostreams program-options python regex serialization signals test thread wave; do \
			lib=libboost-$${name}$(SOVERSION)$(DEBIAN_SUFFIX); \
			echo DH_OPTIONS=-p$${lib} dh_makeshlibs -V"$${lib} (>= 1.34.0~rc2-1)"; \
			DH_OPTIONS=-p$${lib} dh_makeshlibs -V"$${lib} (>= 1.34.0~rc2-1)"; \
		done; \
	fi

	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

# Build architecture independant packages using the common target.
binary-indep: build install
	$(MAKE) -f debian/rules DH_OPTIONS=-i binary-common

# Build architecture dependant packages using the common target.
binary-arch: build install
	$(MAKE) -f debian/rules DH_OPTIONS=-a binary-common

# Any other binary targets build just one binary package at a time.
binary-%: build install
	$(MAKE) -f debian/rules binary-common DH_OPTIONS=-p$*

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary-common binary install
